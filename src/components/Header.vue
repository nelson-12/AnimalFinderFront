<template>
  <div>
  <b-navbar toggleable="lg" type="dark" variant="dark">
    <b-navbar-brand to="/"><svg id="Capa_1"  enable-background="new 0 0 448 448" height="30" viewBox="0 0 448 448" width="30" xmlns="http://www.w3.org/2000/svg"><path d="m282.065 236.81h-3.465c-16.099-.019-31.976-3.767-46.384-10.95l-27.79-13.9.264-.527-12.256 12.257c5.422 2.472 10.044 6.412 13.344 11.374 4.06 6.094 10.9 9.752 18.222 9.746 4.418 0 8 3.582 8 8v16c-.018 14.587-9.881 27.322-24 30.987v22.113c.011 8.693-2.565 17.192-7.4 24.416l-8.6 12.906v18.264l18.343-18.343c3.124-3.124 8.189-3.124 11.314 0 1.5 1.5 2.343 3.535 2.343 5.657v54.4l16-10.6v-59.8c0-2.518 1.186-4.889 3.2-6.4l31.3-23.472c7.5-8.918 11.874-20.046 12.454-31.684.334-6.725.053-13.466-.839-20.14z"/><path d="m225.991 204.81h-.1l13.479 6.739c12.186 6.075 25.614 9.245 39.23 9.261h1.4v-48c0-4.418 3.582-8 8-8h20c6.624-.007 11.993-5.376 12-12v-12h-16c-2.122 0-4.157-.843-5.657-2.343l-16.11-16.11c-3.541-3.563-8.36-5.56-13.383-5.547h-17.32c-5.259.003-10.301 2.092-14.023 5.807-13.815 13.737-21.559 32.431-21.507 51.913v14.28h9.991c3.317-.004 6.006-2.693 6.009-6.01v-25.99h16v25.99c-.014 12.15-9.859 21.996-22.009 22.01zm30.009-72h16v16h-16z"/><path d="m256 398.02 16-10.596v-46.614l-16 12z"/><path d="m442.8 120.38c-3.453-12.761-8.573-25.01-15.23-36.432-30.925-53.018-98.974-70.927-151.991-40.002-12.821 7.478-24.014 17.449-32.919 29.324l-12.26 16.34c-2.651 3.535-7.665 4.251-11.2 1.6-.606-.455-1.145-.994-1.6-1.6l-12.26-16.34c-21.043-27.921-53.948-44.375-88.91-44.46h-3.03c-37.999-.002-73.363 19.414-93.76 51.474-12.838 20.148-19.652 43.545-19.64 67.436v23.13c-.099 61.617 30.081 119.351 80.733 154.438l8.052-12.077c-14.866-11.041-28.252-23.947-39.828-38.401l-7.204-9c-2.761-3.45-2.203-8.486 1.247-11.247s8.486-2.203 11.247 1.247l7.2 9.006c10.547 13.168 22.716 24.949 36.219 35.064l22.33-33.5v-22.61c0-.7.012-1.4.035-2.1.581-13.503 5.688-26.418 14.5-36.667l11.373-13.373c2.863-3.366 7.911-3.773 11.277-.911 1.272 1.082 2.173 2.534 2.578 4.154l6.487 25.937h6.44l27.314-27.313v-18.967c-.064-23.728 9.368-46.495 26.193-63.227 6.722-6.716 15.835-10.489 25.337-10.493h17.32c9.27-.025 18.164 3.659 24.7 10.232l13.764 13.768h20.686c4.418 0 8 3.582 8 8v20c-.018 15.457-12.543 27.982-28 28h-12v39.469l5.97 44.713c1.021 7.64 1.342 15.357.96 23.056-.718 14.448-5.939 28.31-14.93 39.642v49.137l75.763-50.177c52.666-34.784 84.318-93.714 84.237-156.83v-10.3c0-13.219-1.748-26.38-5.2-39.14zm-408.27 116.02c-4.187 1.399-8.716-.861-10.115-5.049-.001-.004-.003-.008-.004-.011l-1.244-3.73c-4.751-14.241-7.171-29.155-7.167-44.167v-2.633c0-4.418 3.582-8 8-8s8 3.582 8 8v2.633c-.004 13.293 2.139 26.499 6.346 39.108l1.243 3.729c1.398 4.191-.867 8.722-5.059 10.12zm371.717 29.41-7.2 9.006c-16.997 21.281-37.879 39.143-61.537 52.637l-21.537 12.306c-3.84 2.186-8.724.844-10.91-2.995-2.18-3.831-.851-8.703 2.972-10.897l21.537-12.307c21.906-12.494 41.242-29.033 56.981-48.738l7.2-9.006c2.729-3.474 7.759-4.078 11.233-1.349s4.078 7.759 1.349 11.233c-.029.037-.058.074-.088.11zm25.753-82.367c.004 15.012-2.416 29.926-7.167 44.167l-1.244 3.73c-1.356 4.205-5.865 6.514-10.07 5.158s-6.514-5.865-5.158-10.07c.016-.05.033-.099.049-.148l1.243-3.73c4.207-12.609 6.35-25.815 6.346-39.107v-2.633c0-4.418 3.582-8 8-8s8 3.582 8 8v2.633zm0-34.633c0 4.418-3.582 8-8 8s-8-3.582-8-8v-8c0-4.418 3.582-8 8-8s8 3.582 8 8z"/><path d="m177.343 352.373 9.95-14.929c3.076-4.596 4.715-10.004 4.707-15.534v-29.1c0-4.418 3.582-8 8-8 8.832-.01 15.99-7.168 16-16v-8.85c-9.63-2.073-18.072-7.819-23.533-16.018-2.96-4.459-7.959-7.137-13.311-7.132h-19.156c-3.671 0-6.871-2.499-7.761-6.06l-4.226-16.9-1.289 1.516c-6.476 7.493-10.245 16.947-10.7 26.841-.016.511-.025 1.043-.025 1.566v25.037c0 1.58-.468 3.124-1.344 4.438l-40.585 60.877 4.582 3 16.836 11.03 64.3 42.125-2.946-5.894c-.554-1.11-.843-2.335-.842-3.576v-24c0-1.579.467-3.123 1.343-4.437zm-9.343-83.563v-16h16v16z"/><path d="m199.153 393.227c.557 1.112.847 2.339.847 3.583v6.713l8 5.241v-24.641l-8.932 8.933z"/></svg></b-navbar-brand>
    <b-collapse id="nav-collapse" is-nav>
      <!-- Right aligned nav items -->
      <b-navbar-nav class="ml-auto">
        <b-nav-item to="/signin" v-if="!signedIn()">Login</b-nav-item>
        <b-nav-item to="/signup" v-if="!signedIn()">Cadastro</b-nav-item>
        <b-nav-item-dropdown right v-if="signedIn()">
          <!-- Using 'button-content' slot -->
          <template v-slot:button-content>
            <em>Usuario</em>
          </template>
          <b-dropdown-item to="/animal/index" v-if="signedIn()">Admin</b-dropdown-item>
           <b-dropdown-item to="/animal/add" v-if="signedIn()">Cadastrar Animal</b-dropdown-item>
          <b-dropdown-item href="#" @click.prevent="signOut" class="link-grey px-2 no-underline" v-if="signedIn()">Sair</b-dropdown-item>
        </b-nav-item-dropdown>
      </b-navbar-nav>
    </b-collapse>
  </b-navbar>
</div>
</template>

<script>
export default {
  name: 'Header',
  created () {
    this.signedIn()
  },
  update(){
    this.signedIn()
  },
  methods: {
    setError (error, text) {
      this.error = (error.response && error.response.data && error.response.data.error) || text
    },
    signedIn () {
      return localStorage.signedIn
    },
    signOut () {
      this.$http.secured.delete('/signin')
        .then(response => {
          delete localStorage.csrf
          delete localStorage.signedIn
          this.$router.replace('/')
        })
        .catch(error => this.setError(error, 'Cannot sign out'))
    }
  }
}
</script>
